function tp__replaceDropdown(t){t.hasClass("open")?t.removeClass("open"):t.addClass("open")}function undo(){tp__undo()}function initLibrary(){tp__library__init()}function addEditUi(t,e){tp__record__addEditUi(t,e)}function addEditFieldEvents_new(t){tp__record__addEditFieldEvents(t)}function addEditOnReady(t){tp__record__addEditOnReady(t)}function getshortcuttool(){return tp__library__getshortcuttool()}function updateUndoButton(){tp__updateUndoButton()}function sortModeOn(){tp__sortModeOn()}function openLibrary(t){tp__library__open(t)}function delRecord(t){tp__delRecord(t)}function tp__upRecord(t){upRecord(t)}function tp__downRecord(t){downRecord(t)}function off__upRecord(t){offRecord(t)}function dublicateRecord(t){tp__dublicateRecord(t)}function savesortmodeifactive(){tp__savesortmodeifactive()}function updateRecord(t){tp__updateRecord(t)}function showUndoButton(){tp__showUndoButton()}function tp_show_leftdrop(){tp__menu__showLeftdrop()}function tp_leftdrop_folder_toggle(t){tp__menu__leftdrop__toggleFolder(t)}function converttozero(t){tp__convertRecordtoZero(t)}function scrollTo(t){tp__scrollTo(t)}function deleteRecordsSelected(){tp__deleteRecordsSelected()}function selected_records_movemodeon(){tp__selectedrecords__movemodeon()}function selected_records_pastemodeon(){tp__selectedrecords__pastemodeon()}function cancelSelect(){tp__cancelSelect()}function tp_showLimitsOutNotice(){tp__showLimitsOutNotice()}function showCornerNotice(t,e){tp__showCornerNotice(t,e)}function showFormCritycalText(t,e,i,o,a,s){return tp__record__showFormCritycalText(t,e,i,o,a,s)}function showCritycalText(t,e){return tp__record__showCritycalText(t,e)}function addEditUiDel(t){tp__record__addEditUiDel(t)}function showHelpVideo(t){tp__showHelpVideo(t)}function tp_showOnboardingPins(){tp__showOnboardingPins()}function tp_showOnboardingSlider(){tp__showOnboardingSlider()}function tp_showOnboardingZeroSlider(){tp__showOnboardingZeroSlider()}function showguides(){tp__showguides()}function stick_div_to_mouse(t){tp__record__stick_div_to_mouse(t)}function checkLinkCCtoWS(t){tp__checkLinkCCtoWS(t)}function pagePublish(){tp__pagePublish()}function showSortButtons(){tp__showSortButtons()}function selected_records_buf_copy(){tp__selectedrecords__bufCopy()}function pageUnpublish(t){tp__pageUnpublish(t)}function saveRecordsSort(){tp__saveRecordsSort()}function cancelSort(){tp__cancelSort()}function td__delPage(t,e){delPage(t,e)}function delPage(t,i){tp__ajax("/projects/submit/",{comm:"delpage",pageid:t,csrf:getCSRF()},{ctext:"page deletion"},function(t){closepopup();var e="/projects/";void 0!==i&&(e+="?projectid="+i),window.location=e})}function showformEditPageSettings_new(t){showformEditPageSettings(t)}function showformEditPageSettings(a){showLoadIcon(),$.cachedScript("https://tilda.cc/front/js/td-pagesettings-all.min.js?v="+window.ver).done(function(t,e){$.cachedScript("https://tilda.cc/front/js/td-folders.min.js?v="+window.ver).done(function(t,e){$.cachedScript("https://tilda.cc/front/js/td-other.min.js?v="+window.ver).done(function(t,e){$.cachedScript("https://tilda.cc/front/js/punicode.min.js?v="+window.ver).done(function(t,e){var i=getCSRF(),o={comm:"getpagesettings"};o.pageid=a,o.js="js3page",o.csrf=i,showpopup("#popup_pagesettings",""),td__pagesettings__drawBody(a),$("#popup_pagesettings").find(".td-popup-window__middle").append('<div style="text-align:center; padding:100px;" id="pagesettingsloader"><img src="/tpl/img/ajax-loader.gif"></div>'),init_popup(),td__load("/projects/get/getpagesettings/",o,{ctext:"opening page settings dialog"},function(t){$("#pagesettingsloader").remove(),td__pagesettings__init(t)})})})})})}function updatePage(t){location.reload()}function showformEditProjectSettings_new(t,e){t="https://tilda.cc/projects/settings/?projectid="+t;(e=e||"")&&(t+="#tab="+e),window.location.href=t}function showformEditProjectFonts(t){$.cachedScript("https://tilda.cc/front/js/t-popup-page-fonts.min.js?v="+window.ver).done(function(t,e){popup_pgss_fontpairs_init()})}function tp__library__init(){tp__library__prepareData(),tp__library__drawTypes(),tp__library__drawTpls(),tp__library__addEvents(),tp__library__addEvents__toCards(),setTimeout(function(){tp__libSearch__addSearch(),tp__library__markFavoritesTpls()},1e3)}function tp__library__prepareData(){"object"!=typeof $types&&(console.log("ERROR! $types in not set"),$types=[]),"object"!=typeof $tpls&&(console.log("ERROR! $tpls in not set"),$tpls=[]);var i=0;"undefined"!=typeof $uplan&&0<$uplan&&(i=$uplan),"undefined"!=typeof $oplan&&0<$oplan&&(i=$oplan),$.each($tpls,function(t,e){void 0!==e.disableforplan0&&"y"==e.disableforplan0&&"0"==i&&($tpls[t].opacity="0.5",$tpls[t].locked="yes"),void 0!==e.disableforplan1&&"y"==e.disableforplan1&&"1"==i&&($tpls[t].opacity="0.5"),void 0===e.icon&&($tpls[t].icon=""),""!==$tpls[t].icon&&(0===$tpls[t].icon.indexOf("https://static.")||($tpls[t].icon="https://assets.tildacdn.com/files/tplicons/tpl_"+e.id+".png")),void 0===e.iconhover&&($tpls[t].iconhover=""),""!==$tpls[t].iconhover&&(0===$tpls[t].iconhover.indexOf("https://static.")||($tpls[t].iconhover="https://assets.tildacdn.com/files/tplicons/tpl_"+e.id+"_hover.png"))});var e="";"object"==typeof fishes&&"object"==typeof fishes[0]&&(e="y",tp__library__prepareData__Fishes());var a="";"object"==typeof localStorage&&(0==tp__library__commFavorites_LS("read",window.projectid,"").length||(a="y",tp__library__prepareData__Favorites()));var s="",r="";$.each($types,function(t,i){var o=!1;"88"==i.id?(r="y")===e&&(o=!0):"89"==i.id?(s="y")===a&&(o=!0):$.each($tpls,function(t,e){if(i.id==e.type)return!(o=!0)}),!1===o?$types[t].hasnottpls="y":void 0!==$types[t].hasnottpls&&delete $types[t].hasnottpls}),e&&"y"!==r&&$types.unshift({id:"88",is_email:"",sort:"88",title:"My Blocks",title_ru:"Мои блоки",off:"",isfish:"y"}),a&&"y"!==s&&$types.unshift({id:"89",is_email:"",sort:"89",title:"Favorites",title_ru:"Избранное",off:"",isfavorite:"y"})}function tp__library__prepareData__Favorites(){var t;"object"==typeof window.tpls_favorites&&delete window.tpls_favorites,"object"!=typeof localStorage||0!=(t=tp__library__commFavorites_LS("read",window.projectid,"")).length&&(window.tpls_favorites=[],$.each(t,function(t,e){0<e&&(window.tpls_favorites[t]={},window.tpls_favorites[t].tplid=e)}),$.each(window.tpls_favorites,function(i,o){$.each($tpls,function(t,e){o.tplid==e.id&&(window.tpls_favorites[i].id=e.id,window.tpls_favorites[i].title=e.title,void 0!==e.title_ru&&(window.tpls_favorites[i].title_ru=e.title_ru),window.tpls_favorites[i].descr=e.descr,void 0!==e.descr_ru&&(window.tpls_favorites[i].descr_ru=e.descr_ru),window.tpls_favorites[i].icon=e.icon,window.tpls_favorites[i].cod=e.cod)}),window.tpls_favorites[i].type="89",window.tpls_favorites[i].isfavorite="y"}))}function tp__library__prepareData__Fishes(){$.each(fishes,function(i,o){$.each($tpls,function(t,e){o.tplid==e.id&&(void 0===fishes[i].fishid&&(fishes[i].fishid=o.id),fishes[i].id=e.id,""==o.title?(fishes[i].title=e.title,void 0!==e.title_ru&&(fishes[i].title_ru=e.title_ru),fishes[i].descr=""):(fishes[i].descr=e.title,void 0!==e.title_ru&&(fishes[i].descr_ru=e.title_ru)),""!=o.icon?fishes[i].icon=o.icon:"396"==e.id?fishes[i].icon="https://assets.tildacdn.com/files/tplicons/tpl_zero.png":fishes[i].icon="https://assets.tildacdn.com/files/tplicons/tpl_base.png",fishes[i].cod=e.cod,fishes[i].trash=o.trash)}),fishes[i].type="88",fishes[i].isfish="y"})}function tp__library__drawTypes(){var i="";i+="<div class='tp-library__body'>",i+="<div class='tp-library__header'>",i+="<div class='tp-library__header-title-wrapper'><div class='tp-library__header-title'>"+("RU"==lang?"Библиотека блоков":"Block Library")+"</div></div>",i+="<div class='tp-library__header-close-wrapper' onclick='javascript:tp__library__hide();'><div class='tp-library__header-close'><img src='/tpl/img/page/tp-08-close.svg' class='tp-library__header-close-ico'></div></div>",i+="</div>",$.each($types,function(t,e){"y"===e.hasnottpls||(t=12<t?"normal":"600",i+="<div class='tp-library__type-body' data-library-type-id='"+e.id+"'>",i+="<div class='tp-library__type'>",i+="<div class='tp-library__type-title-wrapper'><div class='tp-library__type-title' style='font-weight:"+t+";'>"+("RU"==lang&&void 0!==e.title_ru&&""!==e.title_ru?e.title_ru:e.title)+"</div></div>",i+="<div class='tp-library__type-icon-wrapper'><div class='tp-library__type-icon-plus'><img src='/tpl/img/page/tp-12-down.svg'></div><div class='tp-library__type-icon-minus'><img src='/tpl/img/page/tp-14-line.svg' style='opacity:0.3;'></div></div>",i+="</div>",i+="</div>")}),"y"!=$is_email&&(i+="<div class='tp-library__tn-spacer-top'>&nbsp;</div>",i+="<div class='tp-library__tn'><div class='tp-library__tn-leftcol'><div class='tp-library__tn-title'>"+("RU"==lang?"Нулевой блок":"Zero Block")+"</div><div class='tp-library__tn-descr'>"+("RU"==lang?"Создай свой уникальный блок":"Create your own unique block")+"</div></div><div class='tp-library__tn-rightcol'><img src='/tpl/img/null/zero1_for_big_size_black.svg' class='tp-library__tn-ico'></div></div>",i+="<div class='tp-library__tn-spacer-bottom'>&nbsp;</div>"),i+="</div>",i+="<div class='tp-library-rightside'></div>",$(".tp-library").html(i)}function tp__library__drawTpls(){var i="";$.each($types,function(t,e){"y"===e.hasnottpls||(i+=tp__library__drawTpls__getListHTML(e.id))}),$(".tp-library-rightside").html(i),setTimeout(function(){$(".tp-library__tpls-list-body").each(function(){var t=$(this),e=0;t.find(".tp-library__tpl-icon").each(function(){var t;e<3&&(void 0!==(t=$(this)).attr("src")&&""!=t.attr("src")||void 0===t.attr("data-src")||""==t.attr("data-src")||t.attr("src",t.attr("data-src"))),e++})})},3e3)}function tp__library__drawTpls__getListHTML(i){var o="";return o+="<div class='tp-library__tpls-list-body' id='tplslist"+i+"' data-tpls-for-type='"+i+"'>",o+="<div class='tp-library__tpls-list-body-close'><img src='/tpl/img/page/tp-08-close.svg'></div>",$.each($tpls,function(t,e){e.type==i&&"396"!==e.id&&"421"!==e.id&&(o+=tp__library__getCardHTML(e),e.inlib="y")}),"88"==i&&"object"==typeof window.fishes&&($.each(window.fishes,function(t,e){o+=tp__library__getCardHTML(e),e.inlib="y"}),-1<o.indexOf("data-fish-intrash")&&(o+='<div class="tp-library__btn-showfishesintrash" style="cursor:pointer;text-align:center; font-size:12px; margin-top:30px; margin-bottom:20px;">'+("RU"==lang?'Показать удаленные блоки<br><span style="opacity:0.4;">(хранятся один день)</span>':'Show Blocks in Trash<br><span style="opacity:0.4;">(stored one day)</span>')+"</div>")),"89"==i&&"object"==typeof window.tpls_favorites&&0<window.window.tpls_favorites.length&&($.each(window.tpls_favorites,function(t,e){o+=tp__library__getCardHTML(e),e.inlib="y"}),o+='<div style="text-align:center; font-size:12px; margin-top:30px; margin-bottom:20px; opacity:0.4;">* '+("RU"==lang?"Избранные блоки сохраняются в браузере и привязаны к проекту":"Favorite blocks are stored in the browser and linked to the project")+"</div>"),o+="</div>"}function tp__library__getCardHTML(t){var e="",i="",o="";void 0!==t.isfish&&"y"==t.isfish&&(i="y",void 0!==t.trash&&""!==t.trash&&(o="y"));var a="";return void 0!==t.isfavorite&&"y"==t.isfavorite&&(a="y"),e+="<div class='tp-library__tpl-body "+("y"===a?" tp-library__tpl-body_favorite":"")+"' data-tpl-id='"+t.id+"' "+("yes"===t.locked?"data-tpl-locked='yes'":"")+(void 0!==t.fishid&&0<t.fishid?' data-fish-id="'+t.fishid+'" data-fish-recordid="'+t.recordid+'"':"")+("y"==i&&"y"==o?' data-fish-intrash="y" style="display:none;"':"")+("y"===a?' data-isfavorite="y"':"")+">",e+="<div class='tp-library__tpl-wrapper' "+(void 0!==t.opacity&&""!=t.opacity?"style='opacity:"+t.opacity+"'":"")+">",e+="<div style='position:relative;' class='tp-library__tpl-secwrapper'>",e+="<div style='width:320px; padding-left:10px; padding-right:10px;margin-bottom:10px; text-align:center;' class='tp-library__tpl-thirdwrapper'>","y"!=i&&(e+="<div class='tp-library__tpl-favoriteicon-add'>",e+='<svg style="display:block;" width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 0L8.45833 5.08696H14L9.625 8.19565L11.375 13L7 9.8913L2.625 13L4.375 8.19565L0 5.08696H5.25L7 0Z" fill="black"/></svg>',e+="</div>"),"y"==i&&("y"==o?(e+="<div class='tp-library__tpl-fishicon-recover'>",e+="RU"==lang?"Восстановить":"Recover"):(e+="<div class='tp-library__tpl-fishicon-del'>",e+='<svg style="display:block;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="14px" height="14px"><g><path d="M16.06 2.89V1.11H12v1.78H4.11v4.19h20.07V2.89zM6.11 26.89h16.07l2-16.81H4.11z"></path></g></svg>',e+="</div>",e+="<div class='tp-library__tpl-fishicon-settings'>",e+='<svg style="display:block;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="14px"><path d="M25.72 15.27l1.33-1a2.47 2.47 0 00-.75-4.29l-1.6-.51a1.72 1.72 0 01-1.15-2l.37-1.66A2.43 2.43 0 0020.62 3l-1.55.65a1.68 1.68 0 01-2.15-.79l-.77-1.51a2.41 2.41 0 00-4.3 0l-.77 1.51a1.68 1.68 0 01-2.15.79L7.38 3a2.43 2.43 0 00-3.3 2.8l.37 1.66a1.72 1.72 0 01-1.15 2l-1.6.51a2.47 2.47 0 00-.7 4.27l1.33 1a1.73 1.73 0 01.4 2.29L1.78 19a2.45 2.45 0 002.15 3.77l1.67-.08a1.7 1.7 0 011.76 1.49l.22 1.68a2.42 2.42 0 004 1.49l1.23-1.15a1.68 1.68 0 012.29 0l1.23 1.15a2.42 2.42 0 004-1.49l.22-1.68a1.7 1.7 0 011.76-1.49l1.67.08A2.45 2.45 0 0026.22 19l-.9-1.43a1.73 1.73 0 01.4-2.3zM14 20.77A6.77 6.77 0 1120.77 14 6.77 6.77 0 0114 20.77z"></path></svg>'),e+="</div>"),e+="<img class='tp-library__tpl-icon' data-src='"+t.icon+"' "+(void 0!==t.iconhover&&""!=t.iconhover?"data-src-hover='"+t.iconhover+"'":"")+">",e+="<div class='tp-library__tpl-bottom-wrapper'>",void 0!==t.onlyforadmin&&"y"==t.onlyforadmin&&(e+="<div class='tp-library__tpl-onlyforadmin-title'>Only for admin</div>"),e+="<div class='tp-library__tpl-caption'><span class='tp-library__tpl-cod'>","yes"==t.locked&&(e+="<img class='tp-library__tpl-lock' src='/tpl/img/page/tp-11-lock.svg'>"),e+=t.cod+"</span>&nbsp;&nbsp;<span class='tp-library__tpl-title'>"+("RU"==lang&&void 0!==t.title_ru&&""!==t.title_ru?t.title_ru:t.title)+"&nbsp;&nbsp;</span>"+("RU"==lang&&void 0!==t.descr_ru&&""!==t.descr_ru?t.descr_ru:t.descr)+"</div>",e+="</div>",e+="</div>",e+="</div>",e+="</div>",e+="</div>"}function tp__library__addEvents(){$(".tp-library__type-body").click(function(){var t=$(this),e=t.attr("data-library-type-id");$(".tp-library__tpls-list-body").removeClass("tp-library__tpls-list-body_active"),$("#tplslist"+e).addClass("tp-library__tpls-list-body_active"),$(".tp-library__tpls-list-body_active").css("opacity","0"),$(".tp-library").addClass("tp-library_rightsideopened"),$(".tp-library__type-body").removeClass("tp-library__type-body_active"),t.addClass("tp-library__type-body_active"),$(".tp-library-rightside").animate({scrollTop:0},0),$(".tp-library-rightside").scrollGuard(),setTimeout(function(){$(".tp-library__tpls-list-body").css("margin-top","30px"),$(".tp-library__tpls-list-body").animate({opacity:"1","margin-top":"0px"},500,"easeOutCirc",function(){})},100),setTimeout(function(){$(".tp-library__tpls-list-body_active").find(".tp-library__tpl-icon").each(function(){var t=$(this);void 0!==t.attr("src")&&""!=t.attr("src")||void 0===t.attr("data-src")||""==t.attr("data-src")||t.attr("src",t.attr("data-src"))})},50)}),$(".tp-library__tpls-list-body-close").click(function(){tp__library__hideRightSide()}),$(".tp-library__tn").click(function(){var t="";0<window.afterid&&(t=window.afterid),tp__addRecord("396",t),tp__library__hide()}),$(".tp-library__body").scrollGuard()}function tp__library__addEvents__toCards(){$(".tp-library .tp-library__tpl-icon").unbind("mouseover").mouseover(function(t){var e=$(this),i=e.attr("src"),o=e.attr("data-src-hover");void 0!==o&&""!=o&&e.attr("src",o),e.unbind("mouseout").mouseout(function(){void 0!==o&&""!=o&&void 0!==i&&""!=i&&e.attr("src",i)})}),$(".tp-library .tp-library__tpl-body").unbind("click").click(function(){var t,e=$(this).attr("data-tpl-id"),i="";0<window.afterid&&(i=window.afterid),"yes"==$(this).attr("data-tpl-locked")?tp__library__alertTplDisable(""):(void 0!==$(this).attr("data-fish-id")?0<(t=$(this).attr("data-fish-id"))&&tp__addFishRecord(e,t,i):tp__addRecord(e,i),tp__library__hide())}),$(".tp-library .tp-library__tpl-favoriteicon-add").unbind("click").click(function(t){t.stopPropagation();var e=$(this).closest(".tp-library__tpl-body"),t=e.attr("data-tpl-id"),e=e.attr("data-isfavorite");0<t&&("y"===e?tp__library__delFromFavorites:tp__library__addToFavorites)(t)}),$("#tplslist88").length&&($("#tplslist88 .tp-library__tpl-fishicon-del").unbind("click").click(function(t){t.stopPropagation();t=$(this).closest(".tp-library__tpl-body").attr("data-fish-id");0<t&&confirm("RU"==lang?"Удалить блок из библиотеки?":"Delete block from Library?")&&tp__library__delFish(t)}),$("#tplslist88 .tp-library__tpl-fishicon-settings").unbind("click").click(function(t){t.stopPropagation();t=$(this).closest(".tp-library__tpl-body").attr("data-fish-id");0<t&&tp__library__openFishSettings(t)}),$("#tplslist88 .tp-library__tpl-fishicon-recover").unbind("click").click(function(t){t.stopPropagation();t=$(this).closest(".tp-library__tpl-body").attr("data-fish-id");0<t&&tp__library__recoverFish(t)}),$("#tplslist88 .tp-library__btn-showfishesintrash").unbind("click").click(function(t){var e;t.stopPropagation(),els=$('.tp-library #tplslist88 .tp-library__tpl-body[data-fish-intrash="y"]'),e="y"===window.is_hidden_fishes_showed?(els.css("display","none"),window.is_hidden_fishes_showed="",(e=(e=$(this).html()).replace("Скрыть","Показать")).replace("Hide","Show")):(els.css("display","block"),window.is_hidden_fishes_showed="y",(e=(e=$(this).html()).replace("Показать","Скрыть")).replace("Show","Hide")),$(this).html(e)}),$("#tplslist88 .tp-library__tpl-icon").on("error",function(){var e=$(this);"396"==e.closest(".tp-library__tpl-body").attr("data-tpl-id")?e.attr("src","https://assets.tildacdn.com/files/tplicons/tpl_zero.png"):e.attr("src","https://assets.tildacdn.com/files/tplicons/tpl_base.png");var t=e.attr("data-erroriconcnt");void 0===t&&(t=0),t=+t,t++,e.attr("data-erroriconcnt",t),t<10&&setTimeout(function(){var t=e.attr("data-src");t!==e.attr("src")&&0===t.indexOf("https://screen2.")&&e.attr("src",t)},3e3)}))}function tp__library__open(t){0<t?window.afterid=t:delete window.afterid,$("#closelayer").css("height","100%"),$("#closelayer").click(function(){tp__library__hide()}),$("#mainmenu").finish(),$("#mainmenu").css("top","-60px"),$(".tp-library").css("opacity","0"),$(".tp-library").css("left","0px"),$(".tp-library").animate({opacity:"1"},400,"easeOutCirc",function(){}),$(".tp-library").addClass("tp-library_opened"),$(document).keyup(tp__library__keyUpFunc)}function tp__library__hide(){$(".tp-library").css("left","-1000px"),$("#closelayer").css({height:"1px"}),$("#mainmenu").stop(),$("#mainmenu").animate({opacity:"1",top:"0px"},400,"easeOutCirc"),delete window.afterid,$(document).unbind("keyup",tp__library__keyUpFunc)}function tp__library__hideRightSide(){$(".tp-library__tpls-list-body").removeClass("tp-library__tpls-list-body_active"),$(".tp-library").removeClass("tp-library_rightsideopened"),$(".tp-library__type-body").removeClass("tp-library__type-body_active")}function tp__library__keyUpFunc(t){if(27==t.keyCode)return tp__library__hide(),t.preventDefault(),!1}function tp__libSearch__addSearch(){var t;$(".tp-library__header-title-wrapper").after('<div class="tp-library__header-search-wrapper" onclick="javascript:tp__libSearch__openPanel();"><div class="tp-library__header-search"><img src="/tpl/img/td-search.svg" style="height:20px;" class="tp-library__header-search-ico"></div></div>'),$(".tp-library-rightside").append('<div class="tp-library__tpls-list-body" id="tplslistsearch" data-tpls-for-type="search" style="opacity: 1; margin-top: 0px; min-height:calc(100vh - 45px);"><div>'),$("#tplslistsearch").append('<div class="tp-library__search-wrapper"><input type="text" name="tp-library__search-input" class="tp-library__search-input" placeholder="'+("RU"==lang?"Поиск":"Search")+'"></div>'),$(".tp-library__search-wrapper").append('<img src="/tpl/img/td-search.svg" style="width:13px;opacity:0.3;position:absolute; top:12px;left:15px;">'),$(".tp-library__search-input").keypress(function(){setTimeout(function(){tp__libSearch__doSearch()},200)}),$(".tp-library__search-input").focusin(function(){t=setInterval(tp__libSearch__doSearch,1e3)}),$(".tp-library__search-input").focusout(function(){clearInterval(t)})}function tp__libSearch__openPanel(){$(".tp-library__tpls-list-body").removeClass("tp-library__tpls-list-body_active"),$("#tplslistsearch").addClass("tp-library__tpls-list-body_active"),$(".tp-library").addClass("tp-library_rightsideopened"),$(".tp-library__type-body").removeClass("tp-library__type-body_active"),$(".tp-library-rightside").scrollGuard(),$(".tp-library__search-input").focus()}function tp__libSearch__doSearch(){var t=$(".tp-library__search-input"),i=(i=t.val().toLowerCase()).replace(/(<([^>]+)>)/gi,"");if(t.attr("data-libsearch-fraze-showed")!=i){t.attr("data-libsearch-fraze-showed",i),$("#tplslistsearch").find(".tp-library__tpl-body").remove();var o="",a=0;if(2<i.length){for(var e=i.split(" "),s=0;s<e.length;s++){var r=e[s];2<r.length&&$.each($tpls,function(t,e){"396"!==e.id&&"421"!==e.id&&"y"==e.inlib&&("RU"==lang?(void 0!==e.title_ru&&""!=e.title_ru&&-1!==e.title_ru.toLowerCase().indexOf(r)||void 0===e.title_ru&&void 0!==e.title&&""!=e.title&&-1!==e.title.toLowerCase().indexOf(r)||-1!==e.cod.toLowerCase().indexOf(i))&&(o+=tp__library__getCardHTML(e),a++):(void 0!==e.title&&-1!==e.title.toLowerCase().indexOf(r)||-1!==e.cod.toLowerCase().indexOf(i))&&(o+=tp__library__getCardHTML(e),a++))})}0==a&&(o+="<div class='tp-library__tpl-body' style='pointer-events:none;margin-top:20px;margin-left:10px;opacity:0.4;'>"+("RU"==lang?"Ничего не найдено":"Nothing found")+"</div>")}$("#tplslistsearch").append(o),tp__library__addEvents__toCards(),setTimeout(function(){$("#tplslistsearch").find(".tp-library__tpl-icon").each(function(){var t=$(this);void 0!==t.attr("src")&&""!=t.attr("src")||void 0===t.attr("data-src")||""==t.attr("data-src")||t.attr("src",t.attr("data-src"))})},50)}}function tp__library__getshortcuttool(){var t="";return t+='<div class="tp-shortcuttools__container" id="shortcuttools">',t+='\t<div class="tp-shortcuttools__wrapper">',t+='\t\t<div class="tp-shortcuttools__star"><span class="glyphicon glyphicon-star" style="color:#ccc;"></span></div>',t+='\t\t<div class="tp-shortcuttools__table">',t+='\t\t\t<div class="tp-shortcuttools__one">',t+='\t\t\t\t<div class="tp-shortcuttools__one-item" onclick="tp__library__open(\'\')">',t+='\t\t\t\t\t<div class="tp-shortcuttools__one-item-icon"><span class="glyphicon glyphicon-align-justify" style="color:#fff;"></span></div>',t+='\t\t\t\t\t<div class="tp-shortcuttools__one-item-title" id="tp_btn_allblock">'+("RU"==lang?"Все блоки":"More blocks")+"</div>",t+="\t\t\t\t</div>",t+="\t\t\t</div>",t+='\t\t\t<div class="tp-shortcuttools__space">',t+="\t\t\t</div>",t+='\t\t\t<div class="tp-shortcuttools__two">',"y"!=$is_email&&(t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('18','')\">"+("RU"==lang?"Обложка":"Cover")+"</div>",t+="           \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('33','')\">"+("RU"==lang?"Заголовок: средний":"Medium Title")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('127','')\">"+("RU"==lang?"Лид":"Lead")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('106','')\">"+("RU"==lang?"Текст":"Text")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('36','')\">"+("RU"==lang?"Фраза":"Impact")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('3','')\">"+("RU"==lang?"Изображение":"Image")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('670','')\">"+("RU"==lang?"Галерея":"Gallery")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title\" onclick=\"tp__addRecord('219','')\">"+("RU"==lang?"Линия":"Line")+"</div>"),"y"==$is_email&&(t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('323','')\">"+("RU"==lang?"Заголовок":"Title")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('329','')\">"+("RU"==lang?"Текст":"Text")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('322','')\">"+("RU"==lang?"Изображение":"Image")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('618','')\">"+("RU"==lang?"Кнопка":"Button")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('637','')\">"+("RU"==lang?"Линия":"Line")+"</div>",t+="            \t<div class=\"tp-shortcuttools__two-item-title tp-shortcuttools__two-item_right-border\" onclick=\"tp__addRecord('619','')\">"+("RU"==lang?"Отступ":"Space")+"</div>"),t+="\t\t\t</div>",t+='\t\t\t<div class="tp-shortcuttools__space">\t\t\t</div>',"y"!=$is_email&&(t+='\t\t\t<div class="tp-shortcuttools__one tp-shortcuttools__one_white tp-shortcuttools__zero">',t+="\t\t\t\t<div class=\"tp-shortcuttools__one-item\" onclick=\"tp__addRecord('396','')\">",t+="\t\t\t\t\t<div class=\"tp-shortcuttools__one-item-icon\"><img src='/tpl/img/null/zero1_for_small_size_black.svg'></div>",t+='\t\t\t\t\t<div class="tp-shortcuttools__one-item-title">Zero</div>',t+="\t\t\t\t</div>",t+="\t\t\t</div>"),t+="\t\t</div>",t+="\t</div>",t+="</div>"}function tp__library__alertTplDisable(t){"flag1"==t&&alert("This block is only available on Business plan. Please upgrade your subscription or activate trial period."),""==t&&(t="<center><div style='padding:80px; font-size:20px;'><img src='https://static.tildacdn.com/6890b245-1402-4b7d-8379-ce30189779fb/ic2.jpg' width='200px'><br><br>"+("RU"==window.lang?"К сожалению, этот блок доступен только на платных аккаунтах.":"Sorry, this block is only available on paid plans")+"<br><br><a class='btn btn-default btn-lg' role='button' href='/identity/plan/' style='margin-right:10px;' data-dismiss='modal'>"+("RU"==window.lang?"Закрыть":"Close")+"</a><a class='btn btn-primary btn-lg' role='button' href='/identity/plan/' style=''>"+("RU"==window.lang?"Активировать пробный период":"Plans and Billing")+"</a></div></center>",tp__library__alertTplDisableOpenPopup(),$("#myModalContent").html(t),$(document).on("mousedown",function(t){$(t.target).closest("#myModalContent").length||tp__library__alertTplDisableClosePopup(),t.stopPropagation()}),$(document).keydown(function(t){27==t.keyCode&&tp__library__alertTplDisableClosePopup()}),$('.btn[data-dismiss="modal"]').on("click",function(t){t.preventDefault(),tp__library__alertTplDisableClosePopup()}))}function tp__library__alertTplDisableOpenPopup(){var t=$("body"),e=$("#myModal");t.addClass("modal-open tm-popup_open"),t.append('<div class="modal-backdrop fade in tm-popup__backdrop tm-popup__backdrop_fade tm-popup__backdrop_in"></div>'),e.addClass("in tm-popup_in"),e.css("display","block")}function tp__library__alertTplDisableClosePopup(){$("body").removeClass("modal-open tm-popup_open"),$("#myModal").removeClass("in tm-popup_in"),$("#myModal").css("display","none"),$(".modal-backdrop").remove(),$(".tm-popup__backdrop").remove()}function tp__library__delFish(e){tp__ajax("/page/submit/",{comm:"library_delfish",pageid:window.pageid,fishid:e},{ctext:"delete block from library"},function(t){""==t?($('.tp-library .tp-library__tpl-body[data-fish-id="'+e+'"]').remove(),0===$(".tp-library #tplslist88 .tp-library__tpl-body").length&&($('.tp-library .tp-library__type-body[data-library-type-id="88"]').remove(),$('.tp-library .tp-library__type-body[data-library-type-id="1"]').trigger("click"))):td__showBubbleNotice(t,6e3)})}function tp__library__recoverFish(t){tp__ajax("/page/submit/",{comm:"library_recoverfish",pageid:window.pageid,fishid:t},{ctext:"recover block from library trash"},function(t){""==t?tp__library__updateFishesList():td__showBubbleNotice(t,6e3)})}function tp__library__addFish(t,e){var i="<html>"+$("head")[0].outerHTML+'<body style="padding:0;margin:0;"><div id="allrecords" class="t-records">'+$("#rec"+t)[0].outerHTML+"</div></body></html>";tp__ajax("/page/submit/",{comm:"library_addfish",pageid:window.pageid,recordid:t,title:e,fullhtml:i},{ctext:"add block to library"},function(t){""!=t?td__showBubbleNotice(t,6e3):(td__showBubbleNotice("RU"==lang?"Блок добавлен в Библиотеку":"Block added to Libaray",3e3),tp__library__updateFishesList())})}function tp__library__updateFishRecordData(t){tp__ajax("/page/submit/",{comm:"library_updatefishrecorddata",pageid:window.pageid,recordid:t},{ctext:"update block in library"},function(t){""!=t?td__showBubbleNotice(t,6e3):td__showBubbleNotice("RU"==lang?"Блок обновлен в Библиотеке":"Block updated in Library",3e3)})}function tp__library__openFishSettings(i){showLoadIcon(),$.cachedScript("https://front.tildacdn.com/ccpage/js/t-popup-page-fish.js?v="+window.ver).done(function(t,e){hideLoadIcon(),tp__fishsettings__init(i)})}function tp__library__updateFishesList(){0!==$("#tplslist88").length?tp__ajax("/page/submit/",{comm:"library_getfishes",pageid:window.pageid},{ctext:"load user blocks list for library"},function(t){if(""!=t&&(i=tp__parseJson(t)),""==t||"object"!=typeof i||null==i||"object"!=typeof i[0])return console.log(t),td__showBubbleNotice(t,6e3),void location.reload();window.fishes=i;var e,t=$(".tp-library .tp-library__type-body_active");void 0!==t&&1==t.length&&(e=t.attr("data-library-type-id")),tp__library__prepareData__Fishes();var i=tp__library__drawTpls__getListHTML("88");$("#tplslist88").replaceWith(i),tp__library__addEvents__toCards(),void 0!==e&&0<e&&void 0!==(t=$('.tp-library .tp-library__type-body[data-library-type-id="'+e+'"]'))&&t.length&&t.trigger("click")}):location.reload()}function tp__library__commFavorites_LS(t,e,i){var o,a=localStorage.getItem("tp-favorites"+("y"===$is_email?"-email":""));if(o="string"!=typeof a||null===a||""==a||0!==a.indexOf("{")?{}:tp__parseJson(a),"read"==t){var s=o["project"+e];return"object"==typeof s&&null!==s||(s=[]),s}"save"==t&&(o["project"+e]=i,""==(a=JSON.stringify(o))||"{}"==a?localStorage.removeItem("tp-favorites"+("y"===$is_email?"-email":"")):localStorage.setItem("tp-favorites"+("y"===$is_email?"-email":""),a))}function tp__library__addToFavorites(i){var t,o,a;"object"==typeof localStorage?(t=tp__library__commFavorites_LS("read",projectid,""),o=0,a="",$.each(t,function(t,e){o++,e===i&&(a="y")}),"y"!==a?100<o?td__showBubbleNotice("RU"==lang?"Вы добавили максимальное кол-во блоков в избранное":"You have been added maximum blocks to favorites",6e3,"error"):(t.push(i),tp__library__commFavorites_LS("save",projectid,t),tp__library__updateFavoritesList(),$('.tp-library .tp-library__tpl-body[data-tpl-id="'+i+'"]').addClass("tp-library__tpl-body_favorite").attr("data-isfavorite","y"),td__showBubbleNotice("RU"==lang?"Блок добавлен в Избранное":"Block added to Favorites",6e3)):td__showBubbleNotice("Block already added to Favorites",6e3)):alert("Sorry. Your browser is not support this feature")}function tp__library__delFromFavorites(i){var t,o,a,s;"object"==typeof localStorage?(t=tp__library__commFavorites_LS("read",projectid,""),o=0,a="",s=[],$.each(t,function(t,e){e===i?a="y":(o++,s.push(e))}),t=s,""!==a?(tp__library__commFavorites_LS("save",projectid,t),0<o?($('.tp-library #tplslist89 .tp-library__tpl-body[data-tpl-id="'+i+'"]').remove(),$('.tp-library .tp-library__tpl-body[data-tpl-id="'+i+'"]').removeClass("tp-library__tpl-body_favorite").removeAttr("data-isfavorite","y")):("object"==typeof window.tpls_favorites&&delete window.tpls_favorites,tp__library__reinit()),td__showBubbleNotice("RU"==lang?"Блок удален из Избранного":"Block removed from Favorites",6e3)):td__showBubbleNotice("Block not in Favorites",6e3)):alert("Sorry. Your browser is not support this feature")}function tp__library__updateFavoritesList(){if("object"==typeof localStorage){if(0===$("#tplslist89").length)return tp__library__reinit(),void $('.tp-library__type-body[data-library-type-id="89"]').trigger("click");var t,e=$(".tp-library .tp-library__type-body_active");1==e.length&&(t=e.attr("data-library-type-id")),tp__library__prepareData__Favorites();var i=tp__library__drawTpls__getListHTML("89");$("#tplslist89").replaceWith(i),tp__library__addEvents__toCards(),89==t&&(e=$('.tp-library .tp-library__type-body[data-library-type-id="'+t+'"]')).length&&e.trigger("click")}}function tp__library__markFavoritesTpls(){var i;"object"==typeof window.tpls_favorites&&(i=$(".tp-library"),$.each(window.tpls_favorites,function(t,e){i.find('.tp-library__tpl-body[data-tpl-id="'+e.tplid+'"]').addClass("tp-library__tpl-body_favorite").attr("data-isfavorite","y")}))}function tp__library__reinit(){var t,e=$(".tp-library .tp-library__type-body_active");1==e.length&&(t=e.attr("data-library-type-id")),$(".tp-library").removeClass("tp-library_rightsideopened").html(""),tp__library__init(),void 0!==t&&0<t&&(void 0!==(t=$('.tp-library .tp-library__type-body[data-library-type-id="'+t+'"]'))&&t.length&&t.trigger("click"))}function tp__showHelpVideo(t){var e="<center><iframe width='820' height='461' style='paddong-top:20px; padding-bottom:20px;' src='//www.youtube.com/embed/"+("RU"==window.lang?"d7N8ySbq1Bo":"ciBkX_0KQKk")+"?rel=0&autoplay=1' frameborder='0' allowfullscreen></iframe></center>";"popup"==t?($(".onboardingpin").css("display","none"),t="<div class='modal-header tm-popup__window-header'><button type='button' class='close tm-popup__close' data-dismiss='modal' aria-hidden='true'>&times;</button><h4 class='modal-title tm-popup__window-title' id='myModalLabel'>"+("RU"==window.lang?"Посмотрите короткий ролик как редактировать страницу":"Watch a short video on how to edit a page")+"</h4></div><div id='myModalBody'><br>"+e+"</div>",tp__openPopupHelpVideo(),$("#myHelpModal .modal-dialog").css("width","860px"),$("#myHelpModal .tm-popup__wrap").css("width","860px"),$("#myHelpModalContent").html(t),$(document).on("mousedown",function(t){$(t.target).closest("#myHelpModalContent").length||tp__closePopupHelpVideo(),t.stopPropagation()}),$(document).keydown(function(t){27==t.keyCode&&tp__closePopupHelpVideo()}),$('.close[data-dismiss="modal"]').on("click",function(t){t.preventDefault(),tp__closePopupHelpVideo()}),$('.tm-popup__close[data-dismiss="modal"]').on("click",function(t){t.preventDefault(),tp__closePopupHelpVideo()})):$("#helpvideoplace").html(e)}function tp__openPopupHelpVideo(){var t=$("body"),e=$("#myHelpModal");e.css("outline","none"),t.addClass("modal-open tm-popup_open"),t.append('<div class="modal-backdrop fade in tm-popup__backdrop tm-popup__backdrop_fade tm-popup__backdrop_in"></div>'),e.addClass("in tm-popup_in"),e.css("display","block")}function tp__closePopupHelpVideo(){$("body").removeClass("modal-open tm-popup_open"),$("#myHelpModalContent").html(""),$(".onboardingpin").css("display","block"),$("#myHelpModal").removeClass("in tm-popup_in"),$("#myHelpModal").css("display","none"),$(".modal-backdrop").remove(),$(".tm-popup__backdrop").remove()}function tp__showOnboardingPins(){var t="RU"==window.lang?"<span class='onboardingpin__title'>Список страниц и настройки сайта</span>Добавьте больше страниц, настройте шрифты, подключите домен, статистику, формы приема данных и платежную систему.":"<span class='onboardingpin__title'>List of pages & settings</span>Add more pages, customize them, and access Site Settings from your dashboard.";showOnboardingPin("page-onboarding-pin1",t,200,28,"","fixed");t="RU"==window.lang?"<span class='onboardingpin__title'>Опубликуйте страницу</span>Она появится онлайн и вы получите ссылку, по которой любой человек сможет ее увидеть.":"<span class='onboardingpin__title'>Publish the page</span>The webpage will go live. Anyone with the link will be able to view the page.";showOnboardingPin("page-onboarding-pin2",t,50,28,"#page_menu_publishlink","fixed","-110");t="RU"==window.lang?"<span class='onboardingpin__title'>Библиотека блоков</span>Добавьте на страницу новый блок. Выберите подходящий из 550+ блоков, разбитых на категории.":"<span class='onboardingpin__title'>Blocks library</span>Add a new block to the page. Choose from 550+ blocks divided into categories.";showOnboardingPin("page-onboarding-pin3",t,30,0,"#tp_btn_allblock","","","-225")}function tp__showOnboardingSlider(){if($(window).width()<1200)return"";var t;null===localStorage.getItem("tp-obslider")&&(localStorage.setItem("tp-obslider",Date.now()),t="",t+="<div class='tp-obslider'>",t+="\t<div class='tp-obslider__wrap'>",t+="\t\t<div class='tp-obslider-window'>",t+=tp__showOnboardingSlider_getslide(1,"tp-obslider-slide_active"),t+=tp__showOnboardingSlider_getslide(2,""),t+=tp__showOnboardingSlider_getslide(3,""),t+=tp__showOnboardingSlider_getslide(4,""),t+=tp__showOnboardingSlider_getslide(5,""),t+=tp__showOnboardingSlider_getslide_video(6),t+="\t\t</div>",t+="\t</div>",t+="</div>",$("body").append(t),setTimeout(function(){$(".tp-obslider").addClass("tp-obslider_visible")},500),$(document).keyup(tp__showOnboardingSlider_keyUpFunc))}function tp__showOnboardingSlider_getslide(t,e){var i="";return i+="\t\t\t<div class='tp-obslider-slide "+e+"' data-obslide='"+t+"'>",i+="\t\t\t\t<div class='tp-obslider-slide__img' onclick='tp__showOnboardingSlider_nextslide("+t+")'>",i+="\t\t\t\t\t<img src='/tpl/img/page/tp-onboarding_slide_"+t+("RU"==lang?"_ru":"")+".png'>",i+="\t\t\t\t</div>",i+="\t\t\t\t<div class='tp-obslider-slide__text-wrap'>",i+="\t\t\t\t\t<div class='tp-obslider-slide__title'>",1==t&&(i+="RU"==lang?"Вы создали первую страницу!":"You have just created your first page!"),2==t&&(i+="RU"==lang?"Проектируйте страницу, добавляя новые блоки":"Design your page by adding blocks from the library"),3==t&&(i+="RU"==lang?"Настройки и контент блока":"Block Settings and Content"),4==t&&(i+="RU"==lang?"Копируйте, удаляйте и меняйте блоки местами":"Copy, delete and change the order of blocks"),5==t&&(i+="RU"==lang?"Предпросмотр и публикация":"Preview and publishing"),i+="\t\t\t\t\t</div>",i+="\t\t\t\t\t<div class='tp-obslider-slide__text'>",1==t&&(i+="RU"==lang?"Если нужно добавить еще страницы, подключить домен, свой шрифт и т.д., нажмите на название сайта.":"If you need to add more pages, assign a domain, connect your own font, etc., click the website name."),2==t&&(i+="RU"==lang?"Чтобы добавить подходящий в любое место, нажмите на круглую иконку. 550+ блоков готовы для работы.":"Choose the blocks you want and add them to any place on the page. 550+ blocks are ready to use."),3==t&&(i+="RU"==lang?"Используйте кнопку «Контент», чтобы поменять содержание и кнопку «Настройки», чтобы изменить внешний вид блока.":"Use the “Content” button to change the content and “Settings” button to modify the block."),4==t&&(i+="RU"==lang?"Например, используйте стрелки «вверх-вниз» в правом углу, чтобы переместить блок в нужное место.":"Use “up” and “down” arrows in the right corner to move blocks. Open the drop-down menu to cut, copy, paste, and select blocks."),5==t&&(i+="RU"==lang?"Нажмите на кнопку «Опубликовать», и вы получите публичную ссылку, которой сможете поделиться. Либо включите «Предпросмотр», чтобы протестировать сайт.":"Click “Publish” to go live and get a link to your webpage. Preview mode allows you to review the page before publishing."),i+="\t\t\t\t\t</div>",i+="\t\t\t\t</div>",i+="\t\t\t\t<div class='tp-obslider-slide__btn-wrap'>",i+="\t\t\t\t<table style='width:100%;'><tr><td>",i+="\t\t\t\t"+t+" "+("RU"==lang?"из":"of")+" 5",i+="\t\t\t\t</td><td style='text-align:right;'>",1<t&&(i+="\t\t\t\t\t<a class='tp-obslider-slide__btn' href='javascript:tp__showOnboardingSlider_prevslide("+t+")' style='font-size:30px;line-height:24px;color:#aaa; background:none;'> &#8592;</a>"),i+="\t\t\t\t\t<a class='tp-obslider-slide__btn' href='javascript:tp__showOnboardingSlider_nextslide("+t+")' style='font-size:30px;line-height:24px;'> &#8594;</a>",i+="\t\t\t\t</td></tr></table>",i+="\t\t\t\t</div>",i+="\t\t\t</div>"}function tp__showOnboardingSlider_getslide_video(t){var e="";return e+="\t\t\t<div class='tp-obslider-slide' data-obslide='"+t+"'>",e+="\t\t\t\t<div class='tp-obslider-slide__video'>",e+="\t\t\t\t",e+="\t\t\t\t</div>",e+="\t\t\t\t<div class='tp-obslider-slide__text-wrap tp-obslider-slide__text-wrap_video'>",e+="\t\t\t\t\t<table><tr><td style='width:320px;' valign='top'>",e+="\t\t\t\t\t<div class='tp-obslider-slide__title'>",e+="RU"==lang?"Приятной работы!":"Good luck with your project!",e+="\t\t\t\t\t</div>",e+="\t\t\t\t\t<div class='tp-obslider-slide__text'>",e+="RU"==lang?"Если у вас будут вопросы, задайте их через форму в правом нижнем углу.":"If you have any questions don't hesitate to ask us via the form in the right bottom corner.",e+="\t\t\t\t\t</div>",e+="\t\t\t\t\t</td><td class='tp-obslider-slide__btns' style='width:50%; text-align:right;' valign='top'>",e+="\t\t\t\t\t<div style='padding-top:10px;'>",e+="\t\t\t\t\t<a class='tp-obslider-slide__btn' href='javascript:tp__showOnboardingSlider_prevslide("+t+")' style='font-size:30px;line-height:24px;color:#ccc; background:none;'> &#8592;</a>",e+="\t\t\t\t\t\t<a class='tp-obslider-slide__btn' href='javascript:tp__showOnboardingSlider_nextslide("+t+")'>"+("RU"==lang?"Начать редактирование":"Get started")+"</a>",e+="\t\t\t\t\t</div>",e+="\t\t\t\t\t</td></tr></table>",e+="\t\t\t\t</div>",e+="\t\t\t</div>"}function tp__showOnboardingSlider_nextslide(t){var e=+t+1;7==e&&tp__showOnboardingSlider_close(),6==e&&(t="ciBkX_0KQKk","RU"==lang&&(t="d7N8ySbq1Bo"),$(".tp-obslider-window").addClass("tp-obslider-window_video"),t="<iframe width='100%' height='100%' style='' src='//www.youtube.com/embed/"+t+"?rel=0&autoplay=1' frameborder='0' allowfullscreen></iframe>",$(".tp-obslider-slide__video").html(t),$(".tp-obslider-slide__text-wrap_video").find(".tp-obslider-slide__btns").css("display","none").css("opacity","0"),setTimeout(function(){$(".tp-obslider-slide__text-wrap_video").find(".tp-obslider-slide__btns").css("display","table-cell").css("opacity","100")},500)),$(".tp-obslider-slide").removeClass("tp-obslider-slide_active"),$(".tp-obslider-slide[data-obslide='"+e+"']").addClass("tp-obslider-slide_active")}function tp__showOnboardingSlider_prevslide(t){t=+t-1;5==t&&($(".tp-obslider-window").removeClass("tp-obslider-window_video"),$(".tp-obslider-slide__video").html("")),$(".tp-obslider-slide").removeClass("tp-obslider-slide_active"),$(".tp-obslider-slide[data-obslide='"+t+"']").addClass("tp-obslider-slide_active")}function tp__showOnboardingSlider_close(){$(".tp-obslider").removeClass("tp-obslider_visible"),$(".tp-obslider").addClass("tp-obslider_closing"),setTimeout(function(){$(".tp-obslider").remove()},500),$(document).unbind("keyup",tp__showOnboardingSlider_keyUpFunc)}function tp__showOnboardingSlider_keyUpFunc(t){27==t.keyCode&&tp__showOnboardingSlider_close()}function tp__showOnboardingZeroSlider(){if($(window).width()<1200)return"";var t=localStorage.getItem("tp-obslider"),e=localStorage.getItem("tp-obzeroslider");null===e&&null!==t&&(null===e&&0<t&&(Date.now()-t<9e5||1728e6<Date.now()-t)||(localStorage.setItem("tp-obzeroslider",Date.now()),t="",t+="<div class='tp-obslider'>",t+="\t<div class='tp-obslider__wrap'>",t+="\t\t<div class='tp-obslider-window' style='height:565px;'>",t+=tp__showOnboardingZeroSlider_getslide(1,"tp-obslider-slide_active"),t+=tp__showOnboardingZeroSlider_getslide(2,""),t+=tp__showOnboardingZeroSlider_getslide(3,""),t+=tp__showOnboardingZeroSlider_getslide(4,""),t+="\t\t</div>",t+="\t</div>",t+="\t<img src='/tpl/img/page/tp-08-close.svg' style='position:absolute;top:20px;right:20px;width:20px;height:20px;cursor:pointer;' onclick='tp__showOnboardingZeroSlider_close();'>",t+="</div>",$("body").append(t),setTimeout(function(){$(".tp-obslider").addClass("tp-obslider_visible")},500),$(document).keyup(tp__showOnboardingZeroSlider_keyUpFunc)))}function tp__showOnboardingZeroSlider_getslide(t,e){var i="";return i+="\t\t\t<div class='tp-obslider-slide "+e+"' data-obslide='"+t+"'>",i+="\t\t\t\t<div class='tp-obslider-slide__img' onclick='tp__showOnboardingZeroSlider_nextslide("+t+")' style='height:275px;'>",i+="\t\t\t\t\t<img src='/tpl/img/page/tp-onboardingzero_slide_"+t+("RU"==lang?"_ru":"")+".gif' style='height:275px;'>",i+="\t\t\t\t</div>",i+="\t\t\t\t<div class='tp-obslider-slide__text-wrap'>",i+="\t\t\t\t\t<div class='tp-obslider-slide__title'>",1==t&&(i+="RU"==lang?"Zero Block: редактор для дизайна":"Zero Block: web design editor"),2==t&&(i+="RU"==lang?"Zero block: Адаптивность":"Zero block: Adaptive design"),3==t&&(i+="RU"==lang?"Zero block: Анимация":"Zero block: Animation"),4==t&&(i+="RU"==lang?"Zero block: Как добавить":"Zero block: How to add"),i+="\t\t\t\t\t</div>",i+="\t\t\t\t\t<div class='tp-obslider-slide__text'>",1==t&&(i+="RU"==lang?"Профессиональный инструмент внутри Тильды для создания дизайна, как в графических редакторах.":"This is a tool for professional designers inside Tilda which enables to completely edit all elements of the website"),2==t&&(i+="RU"==lang?"Внешний вид страницы настраивается для отображения на мобильных устройствах.":"Page layout could be adapted for mobile devices"),3==t&&(i+="RU"==lang?"Эффект анимации для любого объекта: появление, параллакс, фиксация, изменение по шагам.":"Animation effect for any element: appearing, parallax, fixation, step-by-step animation"),4==t&&(i+="RU"==lang?"Zero Block находится внизу в библиотеке блоков, после категории «Другое»":"Zero Block can be found at the bottom of the block library, right after ‘Other’ category"),i+="\t\t\t\t\t</div>",i+="\t\t\t\t</div>",i+="\t\t\t\t<div class='tp-obslider-slide__btn-wrap'>",i+="\t\t\t\t<table style='width:100%;'><tr><td>",i+="\t\t\t\t"+("RU"==lang?"Слайд":"Slide")+" "+t+" / 4",i+="\t\t\t\t</td><td style='text-align:right;'>",1<t&&(i+="\t\t\t\t\t<a class='tp-obslider-slide__btn' href='javascript:tp__showOnboardingZeroSlider_prevslide("+t+")' style='font-size:30px;line-height:24px;color:#aaa; background:none;'> &#8592;</a>"),i+="\t\t\t\t\t<a class='tp-obslider-slide__btn' href='javascript:tp__showOnboardingZeroSlider_nextslide("+t+")' style='font-size:30px;line-height:24px;'> &#8594;</a>",i+="\t\t\t\t</td></tr></table>",i+="\t\t\t\t</div>",i+="\t\t\t</div>"}function tp__showOnboardingZeroSlider_nextslide(t){t=+t+1;5==t&&tp__showOnboardingZeroSlider_close(),$(".tp-obslider-slide").removeClass("tp-obslider-slide_active"),$(".tp-obslider-slide[data-obslide='"+t+"']").addClass("tp-obslider-slide_active")}function tp__showOnboardingZeroSlider_prevslide(t){t=+t-1;5==t&&($(".tp-obslider-window").removeClass("tp-obslider-window_video"),$(".tp-obslider-slide__video").html("")),$(".tp-obslider-slide").removeClass("tp-obslider-slide_active"),$(".tp-obslider-slide[data-obslide='"+t+"']").addClass("tp-obslider-slide_active")}function tp__showOnboardingZeroSlider_close(){$(".tp-obslider").removeClass("tp-obslider_visible"),$(".tp-obslider").addClass("tp-obslider_closing"),setTimeout(function(){$(".tp-obslider").remove()},500),$(document).unbind("keyup",tp__showOnboardingZeroSlider_keyUpFunc)}function tp__showOnboardingZeroSlider_keyUpFunc(t){27==t.keyCode&&tp__showOnboardingZeroSlider_close()}function showLoadIcon(){$("#loadicon").css({display:"block"})}function hideLoadIcon(){$("#loadicon").css({display:"none"})}function tp__ajax(o,a,s,e,r,i){"/page/publish/"!=o&&showLoadIcon();var l=Date.now();$.ajax({type:"POST",url:o,data:a,dataType:"text",success:function(t){check_logout(t),e(t)},error:function(t,e){var i=Date.now()-l;console.log(t.status),console.log(e),"abort"===e||(400<=t.status?(td__showBubbleNotice("Error status: "+t.status+". (action: "+s.ctext+")",6e3,"error"),logAjaxError(o,a,"tp__ajax ajax error. comm:"+a.comm,t.status,{ts_delta:parseInt(i/1e3),exception:e,ui:s})):0==t.status&&i<100?alert("Request error ("+s.ctext+"). Please check your Internet connection and try again."):(logNetworkError("ajax",o,a,i/1e3,{}),alert("Request timeout ("+s.ctext+"). Please reload the page and try again."))),"function"==typeof r&&r()},complete:function(t){hideLoadIcon(),"function"==typeof i&&i()},timeout:25e3})}function tp__parseJson(e){try{var t=JSON.parse(e);return"object"==typeof t?t:(console.log("error parse json"),console.log(e),"error")}catch(t){return console.log("Error parse server response! error:"+t),console.log(e),"error"}}function tp__checkLinkCCtoWS(t){-1!==t.indexOf("tilda.cc/page/?")&&(t="RU"==lang?"Вы указывайте внутренний адрес страницы в редакторе Тильды. Читайте в документации: <a href='https://help-ru.tilda.cc/link-to-page' target='_blank'>Как поставить ссылку на другую страницу</a>":"You enter an internal page address in the Tilda editor. Read more: <a href='https://help.tilda.cc/link-to-page' target='_blank'>How to set link to other page</a>",td__showBubbleNotice(t,1e4))}function tp__scrollTo(t){0<t&&$("#record"+t).length&&(t=$("#record"+t).offset().top-100,$("html, body").animate({scrollTop:t},500))}function tp__showguides(){$("#guides").length?($("#guides").remove(),$("#guidesmenubutton").css("display","none")):(tp__drawguides(),$("#guidesmenubutton").css("display","block"))}function tp__drawguides(){$("#guides").length&&$("#guides").remove(),$("body").append('<div id="guides"></div>');var t,e=$("#guides"),o=$(window).width(),a=parseInt((o-1200)/2),s=20,r=100;if(o<1200&&(a=parseInt((o-960)/2),r=80,s=10),960<=o)for(i=0;i<13;i++){var l=i*r+a-s,p=i*r+a+s,n=i+1;0!=i&&e.append('<div id="guides_line_l_'+i+'" style="position:fixed; top:0px; left:'+l+'px; height:100vh; background-color:blue; width:1px; opacity:0.3;"></div>'),12!=i&&e.append('<div id="guides_line_r_'+i+'" style="position:fixed; top:0px; left:'+p+'px; height:100vh; background-color:blue; width:1px; opacity:0.3;"></div>'),12!=i&&e.append('<div id="guides_text_r_'+i+'" style="position:fixed; top:60px; left:'+p+'px; height:100vh; color:blue; opacity:0.3; margin-left:5px;">'+n+"</div>")}o<960&&(o=parseInt(o/2),e.append('<div id="guides_line_l" style="position:fixed; top:0px; left:'+o+'px; height:100vh; background-color:blue; width:1px; opacity:0.1;"></div>')),$(window).resize(function(){$("#guides").length&&(clearTimeout(t),t=setTimeout(tp__drawguides,300))})}function tp__menu__showLeftdrop(){$(".tp-menu__leftdrop-list").toggleClass("tp-menu__leftdrop-list_opened"),$(".tp-menu__leftdrop-list").off("mouseleave"),$(".tp-menu__leftdrop-list").on("mouseleave",function(){$(".tp-menu__leftdrop-list").removeClass("tp-menu__leftdrop-list_opened")}),$(".tp-menu__leftdrop-list").find("a").off("click"),$(".tp-menu__leftdrop-list").find("a").on("click",function(){$(".tp-menu__leftdrop-list").removeClass("tp-menu__leftdrop-list_opened")})}function tp__menu__leftdrop__toggleFolder(t){$(".tp-menu__leftdrop-list-wraper").find('[data-leftdrop-folder="'+t+'"]').toggleClass("tp-menu__leftdrop-list-folder_open")}function tp__showCornerNotice(t,e){void 0===e&&(e=6e3),$("body").append("<div class='cornernotice'><div class='cornernotice__text'>"+t+"</div></div>"),$(".cornernotice").animate({opacity:"100",right:"20px"},400,"easeInCirc",function(){setTimeout(function(){$(".cornernotice").animate({opacity:"0",right:"0px"},300,"easeOutCirc",function(){$(this).remove()})},e)})}function tp__showLimitsOutNotice(){var t="";t+="<div style='font-size:20px;'>"+("RU"==lang?"Время идет, работа делается. Пожалуйста, оплатите подписку или перейдите на бесплатный тариф.":"Your subscription plan has expired. Please prolong your subscription or change to Free plan.")+"</div>",t+="<br><br><a href='/identity/plan/' class='btn btn-primary'>"+("RU"==lang?"Тарифы и оплата":"Plans and Billing")+"</a>";t="<div class='modal-header tm-popup__window-header'><button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button><h4 class='modal-title tm-popup__window-title' id='myModalLabel'>"+("RU"==lang?"Пожалуйста, оплатите подписку":"Please renew subscription")+"</h4></div><div id='myModalBody' style='padding:20px;'><br>"+t+"</div>";tp__openPopupLimitsOutNotice(),$("#myHelpModal .modal-dialog").css("width","860px"),$("#myHelpModal .tm-popup__wrap").css("width","860px"),$("#myHelpModalContent").html(t),$(document).on("mousedown",function(t){$(t.target).closest("#myHelpModalContent").length||tp__closePopupLimitsOutNotice(),t.stopPropagation()}),$(document).keydown(function(t){27==t.keyCode&&tp__closePopupLimitsOutNotice()}),$('.close[data-dismiss="modal"]').on("click",function(t){t.preventDefault(),tp__closePopupLimitsOutNotice()}),$('.tm-popup__close[data-dismiss="modal"]').on("click",function(t){t.preventDefault(),tp__closePopupLimitsOutNotice()})}function tp__openPopupLimitsOutNotice(){var t=$("body"),e=$("#myHelpModal");e.css("outline","none"),t.addClass("modal-open tm-popup_open"),t.append('<div class="modal-backdrop fade in tm-popup__backdrop tm-popup__backdrop_fade tm-popup__backdrop_in"></div>'),e.addClass("in tm-popup_in"),e.css("display","block")}function tp__closePopupLimitsOutNotice(){$("body").removeClass("modal-open tm-popup_open"),$("#myHelpModalContent").html(""),$("#myHelpModal").removeClass("in tm-popup_in"),$("#myHelpModal").css("display","none"),$(".modal-backdrop").remove(),$(".tm-popup__backdrop").remove()}function tp__pagePublish(){tp__savesortmodeifactive(),tp__showpublishpopup(),("y"!==window.$is_email&&void 0!==window.projectalias&&""==window.projectalias&&void 0!==window.projectcustomdomain&&""==window.window.projectcustomdomain&&void 0!==window.userwithus&&43200<window.userwithus&&void 0===window.dontaskprojectalias_pagepublish?tp__pagePublish__askProjectAlias:"y"===window.$is_email||void 0===window.pagealias||""!=window.pagealias||void 0===window.pageisindex||"y"==window.pageisindex||void 0!==window.dontaskpagealias_pagepublish?tp__pagePublish_do:tp__pagePublish__askPageAlias)()}function tp__showpublishpopup(){var t="";return t+="<div id='loadingcenter' style='margin:30px; font-size:14px; text-align:center;'>",t+="<br><br>",t+="<img src='/tpl/img/ajax-loader.gif'>",t+="<br><br>",t+="RU"==lang?"Пожалуйста подождите":"Please wait",t+="<br><br><br>",t+="</div>",tp__pagePublish_openPopup(),$("#myModalContent").html(t),$(document).on("mousedown",function(t){$(t.target).closest("#myModalContent").length||t.target.closest(".tm-popup_load")||tp__pagePublish_closePopup(),t.stopPropagation()}),$(document).keydown(function(t){27==t.keyCode&&tp__pagePublish_closePopup()}),$("body").on("click",'.btn[data-dismiss="modal"]',function(t){t.preventDefault(),tp__pagePublish_closePopup()}),t}function tp__pagePublish__askProjectAlias(){window.dontaskprojectalias_pagepublish="yes";var t="";t+="<div style='margin:20px 60px;font-size:14px; text-align:center;'>",t+="<div style='margin-bottom:40px; margin-top:60px;font-size:20px;'>",t+="<div id='pub_setprojectalias_error_div' style='background-color:yellow; color:#000; font-size:18px; display:none; padding:20px; margin-bottom:30px;'></div>",t+="RU"==lang?"Задайте адрес сайта":"Please set site address",t+="</div>",t+='<table width="100%" style="font-size:16px;">',t+="<tr>",t+='<td style="width:100%;"><input type="text" name="projectalias" id="popup-ps-input-projectalias" class="td-input td-item-group__page-url" value="" placeholder="project'+window.projectid+'" style="padding-top:5px;" autofocus></td>',t+='<td><div class="td-item-group__project-url" style="color:#333;" onclick="$(\'#popup-ps-input-projectalias\').focus();">.tilda.ws</div></td>',t+="</tr>",t+="</table>",t+="<div style='margin-top:30px; margin-bottom:30px; font-size:14px; opacity:0.7;'>",t+="RU"==lang?"Изменить адрес сайта или подключить свой домен вы всегда можете в <a href='/projects/settings/?projectid="+window.projectid+"' target='_blank' style='color:#ff8562;'>настройках&nbsp;сайта</a>.":"To change the site address or assign your own domain go to <a href='/projects/settings/?projectid="+window.projectid+"' target='_blank' style='color:#ff8562;'>Site&nbsp;Settings</a>.",t+="</div>",t+='<div style="padding:30px;text-align:center;">',t+='<a href="javascript:tp__skipProjectAlias_and_pagePublish()" type="button" class="btn btn-default">'+("RU"==lang?"Пропустить":"Skip this step")+"</a>",t+='<a href="javascript:tp__saveProjectAlias_and_pagePublish()" type="button" class="btn btn-primary" style="margin-left:10px;">'+("RU"==lang?"Сохранить и продолжить":"Save and continue")+"</a>",t+="</div>",t+="</div>",tp__pagePublish_openPopup(),$("#myModalContent").html(t),$(document).on("mousedown",function(t){$(t.target).closest("#myModalContent").length||tp__pagePublish_closePopup(),t.stopPropagation()}),$(document).keydown(function(t){27==t.keyCode&&tp__pagePublish_closePopup()}),setTimeout(function(){$("#popup-ps-input-projectalias").focus()},1e3),$("#popup-ps-input-projectalias").change(function(){var t,e=$(this).val();""==e||(t=e.replace(/ /g,""))!=e&&(e=t,$(this).val(e)),tp__saveProjectAlias_check(e)})}function tp__skipProjectAlias_and_pagePublish(){tp__pagePublish()}function tp__saveProjectAlias_and_pagePublish(){var t,e=$("#popup-ps-input-projectalias").val();$("#page_menu_publishlink").attr("href","javascript:tp__pagePublish()"),""!==e?(t=getCSRF(),tp__ajax("/projects/submit/",{comm:"saveprojectalias",projectid:window.projectid,alias:e,csrf:t},{ctext:"save project url"},function(t){""==t||"ok"==t?(e=str_stripTags(e),window.projectalias=e,tp__pagePublish()):($("#pub_setprojectalias_error_div").css("display","block"),$("#pub_setprojectalias_error_div").html(t),td__showBubbleNotice(t,6e3,"error"))})):tp__pagePublish()}function tp__saveProjectAlias_check(t){var e="";""!==t&&(t.length<4&&(e="RU"==lang?"<p>Адрес должен содержать не менее 4 символов</p>":"<p>Address must be more than 4 chars</p>"),30<t.length&&(e="RU"==lang?"<p>Адрес должен содержать не более 30 символов</p>":"<p>Address must be less than 30 chars</p>"),/^[A-Za-z0-9.-]*$/.test(t)||(e="RU"==lang?"<p>Адрес может содержать только латинские буквы и цифры</p>":"<p>Address can contian only latin chars and numbers</p>"),-1!==t.indexOf("project")&&(e="RU"==lang?'<p>Извините, адрес не может содержать в себе слово "project"</p>':'<p>Sorry, address can not contian word "Project"</p>'),-1!==t.indexOf("css")&&(e="RU"==lang?'<p>Извините, адрес не может содержать в себе слово "css"</p>':'<p>Sorry, address can not contian word "css"</p>'),-1!==t.indexOf("files")&&(e="RU"==lang?'<p>Извините, адрес не может содержать в себе слово "files"</p>':'<p>Sorry, address can not contian word "files"</p>'),-1!==t.indexOf("index")&&(e="RU"==lang?'<p>Извините, адрес не может содержать в себе слово "index"</p>':'<p>Sorry, address can not contian word "index"</p>')),""!=e?($("#pub_setprojectalias_error_div").css("display","block"),$("#pub_setprojectalias_error_div").html(e)):($("#pub_setprojectalias_error_div").css("display","none"),$("#pub_setprojectalias_error_div").html(""))}function tp__pagePublish__askPageAlias(){window.dontaskpagealias_pagepublish="yes";var t="",e="project"+window.projectid+".tilda.ws";void 0!==window.projectalias&&""!=window.projectalias&&(e=window.projectalias+".tilda.ws"),void 0!==window.projectcustomdomain&&""!=window.projectcustomdomain&&(e=window.projectcustomdomain);33<e.length&&(e="..."+e.substring(e.length-30)),t+="<div style='margin:20px 60px;font-size:14px; text-align:center;'>",t+="<div style='margin-bottom:40px; margin-top:60px;font-size:20px;'>",t+="<div id='pub_setpagealias_error_div' style='background-color:yellow; color:#000; font-size:18px; display:none; padding:20px; margin-bottom:30px;'></div>",t+="RU"==lang?"Укажите адрес страницы":"Please set link for this page",t+="</div>",t+='<table width="100%" style="font-size:16px;">',t+="<tr>",t+='<td><div class="td-item-group__project-url" style="color:#333;" onclick="$(\'#popup-ps-input-pagealias\').focus();">'+e+"/</div></td>",t+='<td style="width:100%;"><input type="text" name="pagealias" id="popup-ps-input-pagealias" class="td-input td-item-group__page-url" value="" placeholder="page'+window.pageid+'.html" style="padding-top:5px;" autofocus></td>',t+="</tr>",t+="</table>",t+="<div style='margin-top:30px; margin-bottom:30px; font-size:14px; opacity:0.7;'>",t+="RU"==lang?"Вы всегда можете изменить адрес <br>в <a href='javascript:showformEditPageSettings_new(\""+window.pageid+"\")' style='color:#ff8562;'>настройках страницы.</a>":"You can always change a page address <br>in <a href='javascript:showformEditPageSettings_new(\""+window.pageid+"\")' style='color:#ff8562;'>Page Settings</a>.",t+="</div>",t+='<div style="padding:30px;text-align:center;">',t+='<a href="javascript:tp__skipPageAlias_and_pagePublish()" type="button" class="btn btn-default">'+("RU"==lang?"Пропустить":"Skip this step")+"</a>",t+='<a href="javascript:tp__savePageAlias_and_pagePublish()" type="button" class="btn btn-primary" style="margin-left:10px;">'+("RU"==lang?"Сохранить и продолжить":"Save and continue")+"</a>",t+="</div>",t+="</div>",tp__pagePublish_openPopup(),$("#myModalContent").html(t),$(document).on("mousedown",function(t){$(t.target).closest("#myModalContent").length||tp__pagePublish_closePopup(),t.stopPropagation()}),$(document).keydown(function(t){27==t.keyCode&&tp__pagePublish_closePopup()}),$("#popup-ps-input-pagealias").focus(),$("#popup-ps-input-pagealias").change(function(){var t,e=$(this).val();""==e||(t=e.replace(/ /g,""))!=e&&(e=t,$(this).val(e)),tp__savePageAlias_check(e)})}function tp__skipPageAlias_and_pagePublish(){tp__pagePublish_do()}function tp__savePageAlias_and_pagePublish(){var t,e=$("#popup-ps-input-pagealias").val();$("#page_menu_publishlink").attr("href","javascript:tp__pagePublish()"),""!==e?(t=getCSRF(),tp__ajax("/projects/submit/",{comm:"savepagealias",pageid:window.pageid,alias:e,csrf:t},{ctext:"save page url"},function(t){""==t||"ok"==t?(e=str_stripTags(e),window.pagealias=e,tp__pagePublish_do()):($("#pub_setpagealias_error_div").css("display","block"),$("#pub_setpagealias_error_div").html(t),td__showBubbleNotice(t,6e3,"error"))})):tp__pagePublish()}function tp__savePageAlias_check(t){var e="";""!==t&&(t.length<1&&(e="RU"==lang?"<p>Адрес должен содержать не менее 1 символа</p>":"<p>Address must be more than 1 chars</p>"),80<t.length&&(e="RU"==lang?"<p>Адрес должен содержать не более 80 символов</p>":"<p>Address must be less than 80 chars</p>"),/^[A-Za-z0-9._\/-]*$/.test(t)||(e="RU"==lang?"<p>Адрес может содержать только латинские буквы и цифры</p>":"<p>Address can contian only latin chars and numbers</p>"),-1!==t.indexOf("css")&&(e="RU"==lang?'<p>Извините, адрес не может содержать в себе слово "css"</p>':'<p>Sorry, address can not contian word "css"</p>'),-1!==t.indexOf("js")&&(e="RU"==lang?'<p>Извините, адрес не может содержать в себе слово "js"</p>':'<p>Sorry, address can not contian word "js"</p>'),-1!==t.indexOf("404")&&(e="RU"==lang?'<p>Извините, адрес не может содержать в себе слово "404"</p>':'<p>Sorry, address can not contian word "404"</p>'),-1!==t.indexOf("403")&&(e="RU"==lang?'<p>Извините, адрес не может содержать в себе слово "403"</p>':'<p>Sorry, address can not contian word "403"</p>')),""!=e?($("#pub_setpagealias_error_div").css("display","block"),$("#pub_setpagealias_error_div").html(e)):($("#pub_setpagealias_error_div").css("display","none"),$("#pub_setpagealias_error_div").html(""))}function tp__pagePublish_openPopup(){var t=$("body"),e=$("#myModal");t.addClass("modal-open tm-popup_open"),t.append('<div class="modal-backdrop fade in tm-popup__backdrop tm-popup__backdrop_fade tm-popup__backdrop_in"></div>'),e.addClass("in tm-popup_in"),e.css("display","block")}function tp__pagePublish_closePopup(){$("body").removeClass("modal-open tm-popup_open"),$("#myModal").removeClass("in tm-popup_in"),$("#myModal").css("display","none"),$(".modal-backdrop").remove(),$(".tm-popup__backdrop").remove()}function tp__pagePublish_do(){tp__savesortmodeifactive(),tp__showpublishpopup();var t=getCSRF();$("body").addClass("tm-popup_load"),tp__ajax("/page/publish/",{pageid:window.pageid,csrf:t,returnjson:"yes"},{ctext:"page publishing"},function(t){$("#myModalContent #loadingcenter").slideUp();var e=tp__pagePublish_parseJson(t);"object"==typeof e&&null!=e?tp__pagePublish_drawResult(e):(console.log("Error response. Can not parse response from server: "+t),$("#myModalContent").html(t),tp__pagePublish_checkpublishban(t),tp__pagePublish_checkerror5xx(t)),$("body").removeClass("tm-popup_load")},function(){tp__pagePublish_closePopup(),$("#myModalContent").html("")})}function tp__pagePublish_parseJson(e){try{var t=JSON.parse(e);return"object"==typeof t?t:(console.log("error parse json"),console.log(e),"error")}catch(t){return console.log("Error parse server response! error:"+t),console.log(e),"error"}return"error"}function tp__pagePublish_drawResult(t){"object"==typeof t&&null!=t&&void 0!==t.linkstr&&""!=t.linkstr&&48<t.linkstr.length&&(t.linkstr=t.linkstr.substring(0,45)+"...");var e="";e+='<div class="modal-body tm-popup__window-body" id="myModalBody"><br>',"yes"!=t.is_email?(e+="<center><div style='font-size:23px;'>",e+="<br><div style='font-size:16px;'>"+("RU"==lang?"Публикация прошла успешно!":"Page was successfully published!")+"</div><br>",e+=("RU"==lang?"Публичная ссылка на эту страницу:":"Public link to the page:")+"<br><b><a href='"+t.link+"' class='js-linkonpage' target='_blank' rel='noopener noreferrer'>"+t.linkstr+"</a></b><br><br>",e+="<center><a href='"+t.link+"' target='_blank' type='button' class='btn-lg btn-primary js-btn-openpage' rel='noopener noreferrer'>"+("RU"==lang?"Открыть страницу":"Open page")+"</a></center>",e+="<br></div></center>",void 0!==t.customdomain&&""!=t.customdomain&&(e+="<center><div style='font-size:16px;'>",e+="RU"==lang?"или используйте системный адрес страницы":"or use system link to the page:",e+="<br><b><a href='"+t.wslink+"' target='_blank' rel='noopener noreferrer'>"+t.wslink+"</a></b><br>",e+="<br></div></center>"),e+="<br><center><div style='font-size:13px; font-family: Georgia; color: #888; width:80%;' class='js-publish-noteunderbutton'>",e+="<i>"+("RU"==lang?"Перейдя по ссылке, пожалуйста, обновите страницу, чтобы увидеть изменения. (Ваш браузер может сохранять старую версию страницы).":"Note: you may need to refresh the page to see the changes, as browsers often store older versions of web pages.")+"</i>",e+="<br></div></center>"):(e+="<center><div style='font-size:24px;'>",e+="<div style='width:560px; margin:0 auto; padding-bottom:40px;'><table style='width:100%;'><tr>",e+="<td class='tp-empub__tab tp-empub__tab_active' data-tabindex='test' style=''>"+("RU"==lang?"Отправить":"Send")+"</td>",e+="<td class='tp-empub__tab' data-tabindex='code' style='border-left:1px #eee solid;border-right:1px #eee solid;'>"+("RU"==lang?"HTML-код письма":"Email HTML-code")+"</td>",e+="<td class='tp-empub__tab' data-tabindex='page' style=''>"+("RU"==lang?"Ссылка на письмо":"Email URL")+"</td>",e+="</tr></table></div>",e+="<div class='tp-empub__card tp-empub__card_active' data-tabindex='test'>",e+="<div style='width:560px;'>",e+="<center><div style='font-size:13px; font-family: Georgia; color: #888; width:80%;'>",""===window.$opaid?e+="<i>"+("RU"==lang?"Для пользователей бесплатного тарифа или пробной версии отправка доступна только на свой email":"Free Plan and trial users can only send newsletter to their emails")+"</i>":e+="<i>"+("RU"==lang?"Укажите не более 3х адресов, перечислив их через запятую":"Please enter a comma-separated list of emails (no more than three)")+"</i>",e+="<br><br><br></div></center>",e+="<input type='text' class='emailsfortest_inp' style='width:100%; max-width:540px; height:50px; padding-left:10px; font-size:16px;' class='' value='"+t.useremail.replace(/"/g,"'")+"' />",e+="<center><div type='button' class='mailsendtest_btn btn-lg btn-primary' style='width:300px; margin-bottom:30px; margin-top:20px;cursor:pointer;'>"+("RU"==lang?"Отправить тестовое письмо":"Send test email")+"</div></center>",e+="<br><center><div style='font-size:13px; font-family: Georgia; color: #888; width:80%;'>",e+="<i>"+("RU"==lang?"Отправить рассылку контактному листу через почтовый сервис":"Send to contacts list via email service")+"</i>",e+="<br><br></div></center>",e+='<a class="btn-lg btn-primary" href="/page/send/?pageid='+t.pageid+'" style="width:300px; margin-bottom:30px; margin-top:20px; display:block;">'+("RU"==lang?"Отправить рассылку":"Send campaign")+"</a>",e+="</div>",e+="</div>",e+="<div class='tp-empub__card' data-tabindex='code'>",e+="<div style='width:560px;'>",e+="<center><div style='font-size:13px; font-family: Georgia; color: #888; width:80%;'>",e+="<i>"+("RU"==lang?"Скопируйте код письма в буфер обмена и вставьте его в вашем сервисе для рассылки":"Copy the letter code to the clipboard and paste it into your mail service")+"</i>",e+="<br><br><br></div></center>",e+="<textarea disabled style='width:100%; max-width:530px; height:100px; font-size:11px; font-family: monospace; padding:10px; background-color:#eee;' class='mailfullhtml_textarea'>"+t.pagefull_nojs+"</textarea>",e+="<center><div href='' type='button' class='mailfullhtml_btn btn-lg btn-primary' style='width:150px; margin-bottom:30px; margin-top:20px;cursor:pointer;'>"+("RU"==lang?"Копировать код":"Copy Code")+"</div></center>",e+="</div>",e+="</div>",e+="<div class='tp-empub__card' data-tabindex='page'>",e+="<div style='font-size:16px;'>"+("RU"==lang?"Публикация прошла успешно!":"Page has been published successfully!")+"</div><br>",e+=("RU"==lang?"Публичная ссылка на эту страницу:":"Public link to the page:")+"<br><b><a href='"+t.link+"' target='_blank' rel='noopener noreferrer'>"+t.link+"</a></b><br><br>",e+="<center><a href='"+t.link+"' target='_blank' type='button' class='btn-lg btn-primary' rel='noopener noreferrer'>"+("RU"==lang?"Открыть страницу":"Open page")+"</a></center>",e+="<br></div></center>",void 0!==t.customdomain&&""!=t.customdomain&&(e+="<center><div style='font-size:16px;'>",e+="RU"==lang?"или используйте системный адрес страницы":"or use system link to the page:",e+="<br><b><a href='"+t.wslink+"' target='_blank' rel='noopener noreferrer'>"+t.wslink+"</a></b><br>",e+="<br></div></center>"),e+="</div>"),e+="</div>",e+=tp__pagePublish_getFooterHtml(t),$("#myModalContent").append(e),"yes"==t.is_email&&tp__pagePublish_addMailEvents()}function tp__pagePublish_getFooterHtml(t){var e="";return e+='<div style="position:absolute; margin-top:40px; margin-left:15px;" class="pub-left-bottom-link">',void 0!==t.customdomain&&""!=t.customdomain?e+='<a href="/projects/settings/?projectid='+window.projectid+'#tab=ss_menu_domain" target="_blank" class="pub-left-bottom-link__domain">'+("RU"==lang?"Подключить домен":"Assign Domain")+"</a>":void 0!==t.ispagefullhasemail&&"y"===t.ispagefullhasemail&&void 0!==window.userwithus&&1209600<window.userwithus?e+='<div style="max-width:400px;font-size:11px;margin-top:-10px;">'+("RU"==lang?"<span style='background-color:yellow; padding:1px 5px; margin-left:-5px;'>Предупреждение:</span> на странице есть Email, который вы используете как логин для входа в Tilda. В целях безопасности рекомендуем держать ваш логин в секрете и не публиковать его на сайте.":"<span style='background-color:yellow; padding:1px 5px; margin-left:-5px;'>Warning:</span> This page contains the email address that you use as your Tilda login. For security reasons, we recommend that you keep your Tilda login email private and do not publish it on the website.")+"</div>":(t=Math.floor(3*Math.random())+1,"RU"==lang?(1==t&&(e+='<a href="https://tilda.education/articles-fonts" target="_blank" style="font-size:13px;color:#777;">Как выбрать правильный шрифт?</a>'),2==t&&(e+='<a href="https://help-ru.tilda.cc/search-engine" target="_blank" style="font-size:13px;color:#777;">Как улучшить SEO?</a>'),3==t&&(e+='<a href="https://tilda.education/design-mistakes" target="_blank" style="font-size:13px;color:#777;">Чек-лист: улучшаем дизайн за 15 минут</a>')):(1==t&&(e+='<a href="https://help.tilda.cc/fonts" target="_blank" style="font-size:13px;color:#777;">How to change website fonts</a>'),2==t&&(e+='<a href="https://help.tilda.cc/search-engine" target="_blank" style="font-size:13px;color:#777;">How to optimize your website for search engines</a>'),3==t&&(e+='<a href="https://help.tilda.cc/metadate" target="_blank" style="font-size:13px;color:#777;">How to publish on Facebook</a>'))),e+="</div>",e+='<div class="modal-footer tm-popup__window-footer">',e+='<button type="button" class="btn btn-default" data-dismiss="modal">'+("RU"==lang?"Закрыть":"Close")+"</button>",e+="</div>"}function tp__pagePublish_addMailEvents(){$(".mailfullhtml_btn").click(function(){var t=$(".mailfullhtml_textarea"),e=(t.val(),t.get(0));origSelectionStart=e.selectionStart,origSelectionEnd=e.selectionEnd,t.removeAttr("disabled"),t.focus(),e.setSelectionRange(0,e.value.length);try{document.execCommand("copy")}catch(t){0}return e.setSelectionRange(origSelectionStart,origSelectionEnd),$(this).html("Copied"),t.attr("disabled","disabled"),!1}),$(".mailsendtest_btn").click(function(){var e,i=$(this),t=$(".emailsfortest_inp").val();return""!==t&&(e=i.html(),i.html("Sending..."),i.prop("disabled",!0),tp__ajax("/page/submit/",{comm:"sendtestemails",pageid:window.pageid,emails:t},{ctext:"sending email"},function(t){""==t?(i.after("RU"==lang?'Письмо отправлено успешно!<br><div style="font-size:12px; padding-top:10px; opacity:0.5;">(Проверьте папку «спам», если не видите письма)</div>':'Email has been sent successfully!<br><div style="font-size:12px; padding-top:10px; opacity:0.5;">(Check Spam folder if you do not see the email)</div>'),i.remove(),$(".emailsfortest_inp").remove()):(i.html(e),i.prop("disabled",!0))},function(){i.html(e),i.prop("disabled",!0)})),!1}),$(".tp-empub__tab").click(function(){var t=$(this);$(".tp-empub__tab").removeClass("tp-empub__tab_active"),t.addClass("tp-empub__tab_active");t=t.attr("data-tabindex");return $(".tp-empub__card").removeClass("tp-empub__card_active"),$(".tp-empub__card[data-tabindex='"+t+"']").addClass("tp-empub__card_active"),!1})}function tp__pagePublish_checkerror5xx(t){"string"==typeof t&&-1<t.indexOf("work on server")&&logAjaxError("/page/publish/","","publish 5xx ajax error: "+t,500,{})}function tp__pagePublish_checkpublishban(t){"string"==typeof t&&-1!==t.indexOf("you have restriction for publishing")&&(t="","RU"==lang?(t+="Спасибо, что используете Тильду.",t+="<br>Для вашего аккаунта есть автоматическое ограничение на функцию публикации, поэтому опубликовать страницу в данный момент не получится.",t+="<br>",t+="<br>Чтобы снять ограничение, пожалуйста, пройдите дополнительную верификацию и сообщите нам информацию о вас и вашем проекте.",t+="<br>",t+='<br>Для этого отправьте на почту <a href="mailto:legal@tilda.cc?subject=Верификация и снятие ограничения на публикацию" target="_blank">legal@tilda.cc</a> письмо, содержащее следующую информацию:',t+="<br>",t+="<br>Тема письма: Верификация и снятие ограничения на публикацию",t+="<br>Текст письма:",t+="<br>1. Название вашей компании или проекта;",t+="<br>2. Цель вашего проекта: коммерческий, некоммерческий или учебный проект;",t+="<br>3. Расскажите коротко, о чем ваш проект;",t+="<br>4. Ссылки на соцсети компании или владельца аккаунта;",t+="<br>5. Номер телефона компании или владельца аккаунта.",t+="<br>",t+="<br>Также укажите ваш аккаунт (ваша@почта, на которую зарегистрирован данный аккаунт).",t+="<br>",t+="<br>Как только мы получим информацию от вас, ограничение будет снято.",t+="<br>Извините за возможные неудобства."):(t+="Thank you for using Tilda.",t+="<br>Unfortunately, your account has a restriction on page publishing, so it is not possible to publish the page at this time.",t+="<br>",t+='<br>To remove the restriction, go through an additional verification step and provide us with further information about yourself and your project. To do this, send an email to <a href="mailto:legal@tilda.cc?subject=Verification and removal of publication restriction" target="_blank">legal@tilda.cc</a> with the following information:',t+="<br>",t+="<br>Email Subject: Verification and removal of publication restriction",t+="<br>Email Body:",t+="<br>1. The name of your company or project;",t+="<br>2. The purpose of your project: commercial, non-commercial, or educational project;",t+="<br>3. Tell us briefly what your project is about;",t+="<br>4. Links to the social media accounts of the company or the account owner;",t+="<br>5. Phone number of the company or account owner.",t+="<br>",t+="<br>Also, specify your Tilda account login email.",t+="<br>",t+="<br>As soon as we hear from you, the restriction will be lifted.",t+="<br>We apologize for any inconvenience this may cause you."),$("#myModalContent").html('<div style="padding:20px;">'+t+"</div>"))}function tp__hideUndoButton(){$(".tp-menu__item-undo").css({display:"none"})}function tp__showUndoButton(){$(".tp-menu__item-undo").css({display:"inline-block"})}function tp__updateUndoButton(){$.ajax({type:"POST",url:"/page/submit/updateundobutton/",data:{comm:"updateundobutton",pageid:window.pageid},dataType:"text",success:function(e){if(""!=e&&("{"===e.substring(0,1)||"["===e.substring(0,1)))try{var t=$.parseJSON(e);"object"==typeof t&&null!==t&&(0==t.undoindex?tp__hideUndoButton:tp__showUndoButton)()}catch(t){console.log("error parse json undo: "+e),console.log(t)}}})}function tp__undo(){"block"!=$("#savesortbuttons").css("display")?"block"!=$("#saveselectbuttons").css("display")?(showLoadIcon(),$.ajax({type:"POST",url:"/page/submit/",data:{comm:"undo",pageid:window.pageid},dataType:"text",success:function(t){hideLoadIcon(),check_logout(t);try{var e=$.parseJSON(t)}catch(t){tp__updateUndoButton()}var i;"object"==typeof e?((0==e.undoindex?tp__hideUndoButton:tp__showUndoButton)(),i=e.recordid,"updaterecord"==e.comm&&0<i&&(tp__updateRecord(i),$("html, body").animate({scrollTop:$("#record"+i).offset().top-100},700)),"showrecord"==e.comm&&0<i&&($("#myfirstrecord")&&$("#myfirstrecord").css({display:"none"}),showLoadIcon(),$.ajax({type:"POST",url:"/page/get/",data:{comm:"getrecordhtml",pageid:window.pageid,recordid:i},dataType:"text",success:function(t){hideLoadIcon(),0<e.afterid?$("#record"+e.afterid).after(t):$("#allrecords").prepend(t),void 0!==window.blockList&&window.blockList.rebuildList(),$("html, body").animate({scrollTop:$("#record"+i).offset().top-100},700)}})),"delrecord"==e.comm&&0<i&&($("html, body").animate({scrollTop:$("#record"+i).offset().top-100},700),$("#record"+i).remove()),"reload"==e.comm&&location.reload()):(console.log("some strange.."),tp__updateUndoButton())},error:function(t){alert("Request timeout (undo)"),hideLoadIcon(),location.reload()},timeout:6e4})):tp__cancelSelect():tp__cancelSort()}function tp__blocksmap__init(){var e=!1,i=!1,o=tp__blocksmap__defineHotkey(),t=$(".blocksmap"),a=$("body").attr("data-lang");tp__blocksmap__appendMap(tp__blocksmap__makeMap(),a),tp__blocksmap__redrawMap(),$('[data-hook="blockmap-button"], .tp-blocksmap__item-header-close').on("click",function(t){t.preventDefault(),tp__blocksmap__displayMap(),saveRecordsSort()});var s=[];t.on("click",".tp-blocksmap__item",function(){var t;e?(i=!1,tp__blocksmap__clickMultipleItem($(this))):i?(t=$(".tp-blocksmap__item_active"),e=!1,$(".tp-blocksmap__item").removeClass("tp-blocksmap__item_active"),1!=t.length&&(t=$(this)),t.addClass("tp-blocksmap__item_active"),0==s.length&&(s[0]=t.attr("data-block-id"),s[1]=t.attr("data-block-id")),2==s.length&&(s[1]=$(this).attr("data-block-id"),$(this).addClass("tp-blocksmap__item_active")),(t=$('.tp-blocksmap__item[data-block-id="'+s[0]+'"]')).addClass("tp-blocksmap__item_active"),s[0]!=s[1]&&(0<t.nextAll('.tp-blocksmap__item[data-block-id="'+s[1]+'"]').length&&t.nextUntil('.tp-blocksmap__item[data-block-id="'+s[1]+'"]').addClass("tp-blocksmap__item_active"),0<t.prevAll('.tp-blocksmap__item[data-block-id="'+s[1]+'"]').length&&t.prevUntil('.tp-blocksmap__item[data-block-id="'+s[1]+'"]').addClass("tp-blocksmap__item_active")),$(".record").removeClass("active"),$(".tp-blocksmap__item_active").each(function(){var t=$(this).attr("data-block-id");$("#record"+t).addClass("active")})):tp__blocksmap__clickOneItem($(this))}),t.on("mouseover",".tp-blocksmap__item",function(){var t=$(this).attr("data-block-id");$(".record").removeClass("hovered"),$("#record"+t).addClass("hovered")}),t.on("mouseout",".tp-blocksmap__item",function(){$(".record").removeClass("hovered")}),$("body").on("keydown",function(t){t=t.keyCode||t.which;t&&t==o&&(i=!(e=!0)),16==t&&(i=!(e=!1))}),$("body").on("keyup",function(){i=e=!1,s=[]});a=void 0===document.documentMode,t=window.chrome;a&&!t?$(window).on("focusout",function(){$("body").hasClass("tp-blocksmap_shown")&&(i=e=!1,s=[])}):window.addEventListener?window.addEventListener("blur",function(){$("body").hasClass("tp-blocksmap_shown")&&(i=e=!1,s=[])},!1):window.attachEvent("blur",function(){$("body").hasClass("tp-blocksmap_shown")&&(i=e=!1,s=[])}),tp__blocksmap__sortable()}function tp__blocksmap__displayMap(){var t=$("body");t.hasClass("tp-blocksmap_shown")?t.removeClass("tp-blocksmap_shown"):t.addClass("tp-blocksmap_shown"),$("#savesortbuttons").hide(),$(".record").removeClass("active hovered"),$(".tp-blocksmap__item").removeClass("tp-blocksmap__item_active")}function tp__blocksmap__redrawMap(){var i=tp__blocksmap__makeMap(),s=tp__blocksmap__makeMap();setTimeout(function t(){var o="",a=[],e=s.length!==i.length||JSON.stringify(s)!==JSON.stringify(i);s=tp__blocksmap__makeMap(),e&&(i=s,$(".tp-blocksmap__item_active").each(function(){a.push($(this).attr("data-block-id"))}),s.forEach(function(e){var i="";a.forEach(function(t){e.recid===t&&(i=" tp-blocksmap__item_active")}),o+='<div class="tp-blocksmap__item'+i+'" data-block-id="'+e.recid+'">',o+="<span><b>"+e.cod+"</b> "+e.title+"</span>",o+="</div>"}),$(".tp-blocksmap-wrapper").html(o)),setTimeout(t,3e3)},3e3)}function tp__blocksmap__makeMap(){"object"!=typeof $tpls&&(console.log("ERROR blocksmap! $tpls in not set"),$tpls=[]);var t=[],o=[],a=[];return $(".record").each(function(){t.push($(this).attr("data-record-type")),o.push($(this).attr("recordid"))}),t.forEach(function(e,i){$tpls.forEach(function(t){t.id==e&&a.push({id:t.id,recid:o[i],cod:t.cod,title:t.title,title_ru:t.title_ru})})}),a}function tp__blocksmap__appendMap(t,i){var o="";o+='<div class="tp-blocksmap__item-header">',o+='<span class="tp-blocksmap__item-header-title">'+("RU"===i?"Блоки на странице":"Blocks on the page")+"</span>",o+='<div class="tp-blocksmap__item-header-close">',o+='<img src="/img/modalClosebutton.png" class="tp-blocksmap__item-header-close-icon">',o+="</div>",o+="</div>",o+='<div class="tp-blocksmap-wrapper">',t.forEach(function(t){var e="RU"===i&&void 0!==t.title_ru&&""!==t.title_ru?t.title_ru:t.title;o+='<div class="tp-blocksmap__item" data-block-id="'+t.recid+'">',o+="<span><b>"+t.cod+"</b> "+e+"</span>",o+="</div>"}),o+="</div>",$(".blocksmap").html(o)}function tp__blocksmap__sortable(){var o=[];$(".tp-blocksmap-wrapper").sortable({connectWith:".tp-blocksmap-wrapper",delay:150,helper:function(t,e){e.hasClass("tp-blocksmap__item_active")||($(".tp-blocksmap__item").removeClass("tp-blocksmap__item_active"),e.addClass("tp-blocksmap__item_active"));var i=e.parent().children(".tp-blocksmap__item_active").clone();return e.data("multidrag",i),e.siblings(".tp-blocksmap__item_active").each(function(t,e){$(e).addClass("tp-blocksmap__hidden-element").hide()}),i.each(function(){o.push($(this).attr("data-block-id"))}),$("<div/>").append(i)},beforeStop:function(t,e){e=$(e.item).prev(".tp-blocksmap__item").attr("data-block-id"),e=$("#record"+e);$(".record").removeClass("active"),o.forEach(function(t){$("#record"+t).addClass("appended active")}),0<e.length?$(".appended").insertAfter(e):$(".appended").prependTo("#allrecords")},stop:function(t,e){var i=e.item.data("multidrag");e.item.after(i).remove(),tp__blocksmap__scrollToBlock($(".appended").first().offset().top-100),o=[],$(".tp-blocksmap__hidden-element").remove(),$(".record").removeClass("appended"),$("#savesortbuttons").show()}})}function tp__blocksmap__clickOneItem(t){var e=t.attr("data-block-id");t.hasClass("tp-blocksmap__item_active")&&1==$(".tp-blocksmap__item_active").length?(t.removeClass("tp-blocksmap__item_active"),$("#record"+e).removeClass("active")):tp__blocksmap__setOnlyOneActiveClass(t,e),tp__blocksmap__scrollToBlock($("#record"+e).offset().top-100)}function tp__blocksmap__setOnlyOneActiveClass(t,e){$(".tp-blocksmap__item").removeClass("tp-blocksmap__item_active"),$(".record").removeClass("active"),t.addClass("tp-blocksmap__item_active"),$("#record"+e).addClass("active")}function tp__blocksmap__clickMultipleItem(t){var e=t.attr("data-block-id");t.hasClass("tp-blocksmap__item_active")?(t.removeClass("tp-blocksmap__item_active"),$("#record"+e).removeClass("active")):(t.addClass("tp-blocksmap__item_active"),$("#record"+e).addClass("active"))}function tp__blocksmap__scrollToBlock(t){$("html, body").animate({scrollTop:t},500,"linear")}function tp__blocksmap__defineHotkey(){var t=-1<navigator.userAgent.indexOf("Macintosh")?(navigator.userAgent.indexOf("Chrome")||navigator.userAgent.indexOf("Safari"),91):17;return t}$(document).ready(function(){var t=location.hash.replace("#scrolltorecord=","");t&&0<t&&(0<(e=parseInt(t,10))&&0<$("#record"+e).length&&($("html, body").animate({scrollTop:$("#record"+e).offset().top-100},700),history.replaceState({},"Tilda:","https://tilda.cc/page/?pageid="+window.pageid)));var e=window.location.search;void 0!==e&&""!=e&&1<e.indexOf("viewtrash=yes")&&setTimeout(function(){alert("RU"==lang?"Пожалуйста, проскролльте страницу. Удаленные блоки отмечены желтым лейблом в левом углу. Нажмите на него, чтобы восстановить блок.":"Please scroll down the page. Deleted blocks are marked with a yellow label in the left corner. Click on it to recover the block.")},2e3),$(".js-btn-preview").length&&$(".js-btn-preview").mousedown(function(){tp__savesortmodeifactive()}),$("#mainmenu .dropdown-toggle").attr("data-toggle",""),$("body").on("click","#mainmenu .tp-menu__item.dropdown",function(){tp__replaceDropdown($(this))}),$("#rightbuttons .dropdown-toggle").attr("data-toggle",""),$("body").on("click","#rightbuttons .tp-record-edit-icons-right__item-icon.dropdown-toggle",function(){tp__replaceDropdown($(this).parents(".tp-record-edit-icons-right__items"))}),$("body").on("mouseleave",".record",function(){$(this).find(".tp-record-edit-icons-right__items").removeClass("open")}),"function"==typeof td__help__showBubble&&td__help__showBubble(),0<$('.t396__artboard[data-artboard-ovrflw="visible"]').length&&($(document).off("mouseenter",".record"),$(document).on("mouseenter",".record",function(t){var e=$(this);t.pageY>e.offset().top+e.outerHeight()&&e.addClass("record_overflowed")}),$(document).off("mouseleave",".record"),$(document).on("mouseleave",".record",function(t){var e=$(this);(t.pageY<e.offset().top+e.outerHeight()||t.pageY>e.offset().top+e.outerHeight())&&e.prev().hasClass("record_overflowed")&&e.prev().removeClass("record_overflowed")}))}),$.fn.scrollGuard=function(){return this.on("wheel",function(t){var e=$(this);return t.originalEvent.deltaY<0?0<e.scrollTop():e.scrollTop()+e.innerHeight()<e[0].scrollHeight})},$(document).ready(function(){tp__blocksmap__init()});
